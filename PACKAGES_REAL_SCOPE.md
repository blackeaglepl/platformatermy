# 📦 Prawdziwy zakres pakietów - Termy Górce

**Data utworzenia:** 2025-10-16
**Źródło danych:** https://termygorce.pl/pakiety/
**Status:** ⚠️ DO ZATWIERDZENIA - nie implementować przed potwierdzeniem!

---

## 🎯 Cel dokumentu

Dokument zawiera **PRAWDZIWY** zakres 6 pakietów oferowanych przez Termy Górce. Dane zostały zebrać z:
1. Oficjalnej strony https://termygorce.pl/pakiety/
2. Bezpośredniego opisu od właściciela projektu

**⚠️ UWAGA:** Obecne dane w bazie są **dummy** i muszą zostać zastąpione!

---

## 📊 Struktura pakietów

### Nomenklatura stref

Każdy pakiet składa się z usług podzielonych na **3 strefy**:

| Strefa | Opis | Przykłady |
|--------|------|-----------|
| **Strefa Odnowy** | Masaże, zabiegi pielęgnacyjne, rytuały | Masaż, peeling, zabiegi twarzy |
| **Strefa Relaksu** | Basen, jacuzzi, sauny, grota solna | Wejście do strefy (z limitem czasu) |
| **Strefa Smaku** | Jedzenie, napoje, vouchery | Kolacja, deser, herbata |

**Specjalne:** Niektóre pakiety mają **warianty do wyboru** (np. Kobiecy Chill)

---

## 📋 Szczegółowy zakres pakietów

### Pakiet 1: Naturalna Harmonia
**Cena:** 449 zł/os. (zamiast 546 zł)
**Typ:** Dla pojedynczej osoby

#### Strefa Odnowy:
1. **Rytuał "Zmysłowa Odnowa"** – 90 min
   - Wariant 1: Księżycowa
   - Wariant 2: Mango
   - **Uwaga:** Klient wybiera jeden wariant przy zakupie
2. **Zabieg Pielęgnacji Twarzy** – 30 min
   - Peeling twarzy + masaż na kremie

#### Strefa Relaksu:
3. **Wejście do Strefy Relaksu** – 2,5 h
   - W cenie: basen termalny, jacuzzi, sauny, grota solna
   - **Uwaga:** To **JEDNA usługa** z limitem czasowym, nie osobne usługi!

#### Strefa Smaku:
4. **Napar herbaciany do wyboru**
   - Wariant 1: Na ciepło
   - Wariant 2: Na zimno

---

### Pakiet 2: Termalna Ulga
**Cena:** 239 zł/os. (zamiast 284 zł)
**Typ:** Dla pojedynczej osoby

#### Strefa Odnowy:
1. **Masaż klasyczny z okładami borowinowymi** – 60 min
   - 30 min masaż + 30 min okłady borowinowe
   - **Uwaga:** To JEDNA usługa, nie dwie!

#### Strefa Relaksu:
2. **Wejście do Strefy Relaksu** – 1,5 h
   - W cenie: basen termalny, jacuzzi, sauny, grota solna

#### Strefa Smaku:
3. **Deser + kawa lub herbata do wyboru**
   - **Uwaga:** To JEDNA usługa (deser + napój)

---

### Pakiet 3: Szept Miłości
**Cena:** 799 zł/para (zamiast 1008 zł)
**Typ:** ⚠️ DLA 2 OSÓB (pakiet romantyczny dla pary)

#### Strefa Odnowy:
1. **Masaż do wyboru – 60 min (x2 osoby)**
   - Wariant 1: Masaż ciepłą świecą
   - Wariant 2: Masaż ciepłą czekoladą
   - **Uwaga:** Każda osoba może wybrać inny wariant!

#### Strefa Relaksu:
2. **Jacuzzi VIP** – 60 min
   - W cenie: 2 lampki prosecco lub drinki bezalkoholowe
   - **Uwaga:** Jacuzzi dla pary, nie publiczne!
3. **Wejście do Strefy Relaksu** – 1,5 h
   - W cenie: basen termalny, jacuzzi publiczne, sauny, grota solna

#### Strefa Smaku:
4. **Romantyczna kolacja** – voucher 200 zł
   - Do wykorzystania w restauracji Term

---

### Pakiet 4: Kobiecy Chill
**Cena:** 499 zł/os. (zamiast 564 zł)
**Typ:** Dla pojedynczej osoby (lub grupy kobiet)

#### Strefa Odnowy (jeden wariant do wyboru):
**Wariant 1:**
1. Masaż relaksacyjny – 30 min
2. Zabieg Pielęgnacji Twarzy – 30 min

**Wariant 2:**
1. Masaż masłem shea – 60 min
2. Peeling całego ciała – 15 min

**⚠️ UWAGA:** Klient wybiera **jeden z dwóch wariantów** przy zakupie!

#### Strefa Relaksu:
3. **Jacuzzi VIP** – 60 min
   - W cenie: butelka prosecco na grupę
4. **Wejście do Strefy Relaksu** – 2,5 h

#### Strefa Smaku:
5. **Voucher do wykorzystania w Strefie Smaku** – 80 zł/os.

---

### Pakiet 5: Wspólna Regeneracja
**Cena:** 299 zł/os. (zamiast 364 zł)
**Typ:** ⚠️ DLA 2 OSÓB (pakiet dla pary/przyjaciół)

#### Strefa Odnowy:
1. **Masaż do wyboru – 60 min (x2 osoby)**
   - Wariant 1: Masaż klasyczny
   - Wariant 2: Masaż ciepłymi olejkami
   - **Uwaga:** Każda osoba może wybrać inny wariant!

#### Strefa Relaksu:
2. **Wejście do Strefy Relaksu** – 2,5 h

#### Strefa Smaku:
3. **Voucher o wartości 80 zł dla każdej osoby**
   - Do wykorzystania w Strefie Smaku
   - **Uwaga:** 2x voucher (osobny dla każdej osoby)

---

### Pakiet 6: Impreza Urodzinowa
**Cena:** 590 zł za pakiet (zamiast 690 zł)
**Typ:** ⚠️ DLA 6 DZIECI (stała liczba uczestników)

#### Strefa Relaksu:
1. **Wejście do Strefy Relaksu** – 1,5 h
   - Dla 6 dzieci

#### Strefa Smaku:
2. **2x karafka lemoniady**
3. **3x pizza margherita**

**⚠️ UWAGA:** To pakiet dla GRUPY, nie dla pojedynczej osoby!

---

## 🔄 Porównanie: Obecne dane (dummy) vs Prawdziwe

### ❌ Co musi zostać usunięte z bazy:

Obecne dummy usługi w `package_services`:
- ❌ "Basen termalny (2h)" - nie ma takiej osobnej usługi
- ❌ "Jacuzzi (30 min)" - jest "Wejście do Strefy Relaksu" zamiast
- ❌ "Leżaki termalne (1h)" - nie występuje w żadnym pakiecie
- ❌ "Masaż relaksacyjny (60 min)" - jest, ale trzeba uzupełnić warianty
- ❌ "Sauna fińska (30 min)" - jest w "Wejściu do Strefy Relaksu"
- ❌ "Grota solna (45 min)" - jest w "Wejściu do Strefy Relaksu"
- ❌ "Peeling ciała (30 min)" - jest "Peeling całego ciała (15 min)"
- ❌ "Masaż gorącymi kamieniami (45 min)" - nie występuje
- ❌ "Kolacja degustacyjna" - nie występuje
- ❌ "Napoje ziołowe" - nie występuje
- ❌ "Śniadanie górskie" - nie występuje
- ❌ "Deser terminalny" - jest "Deser + kawa/herbata"
- ✅ "Wypożycz ręcznik i szlafrok" - OK (is_extra=true)

---

## 📝 Propozycja nowej struktury `package_services`

### Lista wszystkich unikalnych usług (do utworzenia):

#### Strefa Odnowy (zone: odnowy)
| ID | Nazwa | Czas | Warianty | Pakiety |
|----|-------|------|----------|---------|
| 1 | Rytuał "Zmysłowa Odnowa" | 90 min | księżycowa / mango | 1 |
| 2 | Zabieg Pielęgnacji Twarzy (peeling + masaż) | 30 min | - | 1, 4 (wariant 1) |
| 3 | Masaż klasyczny z okładami borowinowymi | 60 min | - | 2 |
| 4 | Masaż (ciepła świeca / czekolada) | 60 min | świeca / czekolada | 3 |
| 5 | Masaż relaksacyjny | 30 min | - | 4 (wariant 1) |
| 6 | Masaż masłem shea | 60 min | - | 4 (wariant 2) |
| 7 | Peeling całego ciała | 15 min | - | 4 (wariant 2) |
| 8 | Masaż (klasyczny / ciepłe olejki) | 60 min | klasyczny / olejki | 5 |

#### Strefa Relaksu (zone: relaksu)
| ID | Nazwa | Czas | Warianty | Pakiety |
|----|-------|------|----------|---------|
| 9 | Wejście do Strefy Relaksu (basen, jacuzzi, sauny, grota) | 2,5 h | - | 1, 4 |
| 10 | Wejście do Strefy Relaksu (basen, jacuzzi, sauny, grota) | 1,5 h | - | 2, 3, 5, 6 |
| 11 | Jacuzzi VIP (z prosecco dla pary) | 60 min | - | 3 |
| 12 | Jacuzzi VIP (z prosecco dla grupy) | 60 min | - | 4 |

#### Strefa Smaku (zone: smaku)
| ID | Nazwa | Czas | Warianty | Pakiety |
|----|-------|------|----------|---------|
| 13 | Napar herbaciany do wyboru | - | ciepło / zimno | 1 |
| 14 | Deser + kawa lub herbata do wyboru | - | - | 2 |
| 15 | Romantyczna kolacja (voucher 200 zł) | - | - | 3 |
| 16 | Voucher Strefa Smaku (80 zł/os.) | - | - | 4, 5 |
| 17 | Karafka lemoniady | - | - | 6 (qty: 2) |
| 18 | Pizza margherita | - | - | 6 (qty: 3) |

#### Extra (zone: extra)
| ID | Nazwa | Uwagi | Pakiety |
|----|-------|-------|---------|
| 19 | Wypożycz ręcznik i szlafrok | Przysługuje 1 raz dla każdej osoby | Wszystkie |

---

## 🔧 Propozycja struktury `package_type_services`

**Legenda:**
- `qty` = quantity (ile razy usługa w pakiecie)
- `is_variant` = czy jest to jedna z kilku opcji do wyboru
- `variant_group` = grupa wzajemnie wykluczających się opcji

### Pakiet 1: Naturalna Harmonia
```
service_id | quantity | is_variant | variant_group
-----------|----------|------------|---------------
1          | 1        | false      | null
2          | 1        | false      | null
9          | 1        | false      | null
13         | 1        | false      | null
19         | 1        | true       | null (extra)
```

### Pakiet 2: Termalna Ulga
```
service_id | quantity | is_variant | variant_group
-----------|----------|------------|---------------
3          | 1        | false      | null
10         | 1        | false      | null
14         | 1        | false      | null
19         | 1        | true       | null (extra)
```

### Pakiet 3: Szept Miłości (dla 2 osób!)
```
service_id | quantity | is_variant | variant_group
-----------|----------|------------|---------------
4          | 2        | false      | null          # 2x masaż (po 1 dla każdej osoby)
11         | 1        | false      | null
10         | 1        | false      | null
15         | 1        | false      | null
19         | 2        | true       | null (extra)  # 2x ręcznik (po 1 dla każdej osoby)
```

### Pakiet 4: Kobiecy Chill (ma warianty!)
```
service_id | quantity | is_variant | variant_group
-----------|----------|------------|---------------
5          | 1        | true       | "odnowa_a"    # Wariant 1 - masaż 30 min
2          | 1        | true       | "odnowa_a"    # Wariant 1 - zabieg twarzy
6          | 1        | true       | "odnowa_b"    # Wariant 2 - masaż shea
7          | 1        | true       | "odnowa_b"    # Wariant 2 - peeling
12         | 1        | false      | null
9          | 1        | false      | null
16         | 1        | false      | null
19         | 1        | true       | null (extra)
```

### Pakiet 5: Wspólna Regeneracja (dla 2 osób!)
```
service_id | quantity | is_variant | variant_group
-----------|----------|------------|---------------
8          | 2        | false      | null          # 2x masaż (po 1 dla każdej osoby)
10         | 1        | false      | null
16         | 2        | false      | null          # 2x voucher (po 1 dla każdej osoby)
19         | 2        | true       | null (extra)  # 2x ręcznik (po 1 dla każdej osoby)
```

### Pakiet 6: Impreza Urodzinowa (dla 6 dzieci!)
```
service_id | quantity | is_variant | variant_group
-----------|----------|------------|---------------
10         | 1        | false      | null          # Wejście dla 6 dzieci (jednorazowe)
17         | 2        | false      | null          # 2x karafka lemoniady
18         | 3        | false      | null          # 3x pizza
19         | 6        | true       | null (extra)  # 6x ręcznik (po 1 dla każdego dziecka)
```

---

## 🚨 Kluczowe uwagi implementacyjne

### 1. Warianty usług (is_variant + variant_group)

**Problem:** Niektóre pakiety mają usługi **do wyboru** (np. Kobiecy Chill).

**Rozwiązanie:** Dodaj kolumny do `package_type_services`:
```sql
ALTER TABLE package_type_services ADD COLUMN is_variant BOOLEAN DEFAULT FALSE;
ALTER TABLE package_type_services ADD COLUMN variant_group VARCHAR(50) DEFAULT NULL;
```

**Logika UI:**
- Jeśli `variant_group` jest taki sam dla kilku usług → wyświetl jako radio buttons
- Użytkownik może wybrać **TYLKO JEDNĄ** usługę z danej grupy
- Po wyborze, tylko wybrana usługa trafia do `package_service_usage`

---

### 2. Pakiety dla wielu osób

**Problem:** Pakiety 3, 5, 6 są dla **wielu osób**.

**Rozwiązanie A - Quantity:**
- Ustaw `quantity > 1` dla usług które przysługują wielokrotnie
- Np. "Masaż" w Pakiecie 3 ma `quantity=2` (dla pary)

**Rozwiązanie B - Dodaj kolumnę `persons_count`:**
```sql
ALTER TABLE packages ADD COLUMN persons_count INTEGER DEFAULT 1;
```

**UI:**
- Pokaż "Pakiet dla X osób" w widoku szczegółów
- Checkboxy dla usług z `quantity > 1` wyświetl X razy
  - Pakiet 3 → "Masaż osoba 1" i "Masaż osoba 2"
  - Pakiet 6 → "Wejście dla 6 dzieci" (pojedynczy checkbox)

---

### 3. "Wejście do Strefy Relaksu" to JEDNA usługa

**Błąd w obecnej bazie:** Rozdzielono na "Basen", "Jacuzzi", "Sauna", "Grota"

**Poprawka:**
- "Wejście do Strefy Relaksu" to **JEDNA usługa z limitem czasowym**
- W środku gość może korzystać z: basenu, jacuzzi, saun, groty solnej
- **NIE** checkować osobno każdej atrakcji!

---

### 4. Vouchery to usługi (nie pieniądze)

**Pakiety 3, 4, 5** zawierają vouchery (80 zł, 200 zł).

**W systemie:**
- Voucher = usługa (row w `package_services`)
- Checkbox "Voucher wykorzystany" = gość wykorzystał voucher
- **NIE** śledzimy za co wydał voucher (to dział restauracji)

---

### 5. Pakiet 6 dla GRUPY (6 dzieci)

**Specyfika:**
- To nie jest 6 osobnych pakietów!
- To JEDEN pakiet grupowy
- Wejście do strefy = dla całej grupy (1x checkbox)
- Pizza = 3 sztuki (3x checkbox)
- Lemoniada = 2 karafki (2x checkbox)
- Ręczniki = 6 sztuk (6x checkbox lub pole numeryczne)

---

## ✅ Decyzje implementacyjne (ZATWIERDZONE)

### Pytanie 1: Warianty usług ✅
**Q:** Jak obsługiwać warianty w Pakiecie 4 (Kobiecy Chill)?

**✅ WYBRANA OPCJA B:** Warianty widoczne w szczegółach pakietu, pracownik checkuje wybrany za pomocą **radio buttons**

**Szczegóły implementacji:**
- **Pakiety z wariantami:**
  1. **Pakiet 3 (Szept Miłości):** Masaż ciepłą świecą / czekoladą (dla każdej z 2 osób)
  2. **Pakiet 4 (Kobiecy Chill):** Wariant A (masaż 30 min + zabieg twarzy) / Wariant B (masaż shea 60 min + peeling)
  3. **Pakiet 5 (Wspólna Regeneracja):** Masaż klasyczny / ciepłymi olejkami (dla każdej z 2 osób)

- **Logika UI:**
  - Warianty wyświetlane jako **radio buttons** (jeden wybór z grupy)
  - Po zaznaczeniu radio buttona przy jednym wariancie, **TYLKO TA USŁUGA** jest trackowana jako wykorzystana
  - Drugi wariant pozostaje **niezaznaczony** (żeby obsługa wiedziała czego klient NIE wybrał)
  - W `package_service_usage` trafia tylko wybrana opcja

**Przykład UI (Pakiet 3):**
```
☐ Masaż ciepłą świecą (60 min) - Osoba 1
☐ Masaż ciepłą czekoladą (60 min) - Osoba 1
☐ Masaż ciepłą świecą (60 min) - Osoba 2
☐ Masaż ciepłą czekoladą (60 min) - Osoba 2
```

**Przykład UI (Pakiet 4):**
```
Wariant A:
  ⚪ Masaż relaksacyjny (30 min)
  ⚪ Zabieg Pielęgnacji Twarzy (30 min)

Wariant B:
  ⚪ Masaż masłem shea (60 min)
  ⚪ Peeling całego ciała (15 min)
```

---

### Pytanie 2: Pakiety dla wielu osób ✅
**Q:** Jak rozróżniać osoby w pakietach 3, 5, 6?

**✅ WYBRANA OPCJA A:** Quantity + numeracja ("Masaż osoba 1", "Masaż osoba 2")

**Szczegóły implementacji:**
- **NIE** tworzymy dodatkowej tabeli `package_persons`
- Używamy pola `quantity` w `package_type_services` do określenia ile razy usługa przysługuje
- **Instrukcja dla obsługi:** Jeśli pakiet jest dla większej liczby osób (np. grupa 4 kobiet dla Pakietu 4), obsługa tworzy **N osobnych pakietów** w systemie
  - Np. "Kowalska_Pakiet4_1", "Kowalska_Pakiet4_2", "Kowalska_Pakiet4_3", "Kowalska_Pakiet4_4"

**Przykład (Pakiet 3 - dla 2 osób):**
```
✅ Masaż (ciepła świeca) - Osoba 1 - wykorzystano 2025-10-16
☐ Masaż (ciepła czekolada) - Osoba 2
☐ Jacuzzi VIP (60 min)
☐ Wejście do Strefy Relaksu (1,5 h)
☐ Romantyczna kolacja (voucher 200 zł)
```

**Uwaga:** Dla **Pakietu 6 (Impreza Urodzinowa)** - to JEDEN pakiet dla 6 dzieci (nie tworzymy 6 osobnych!)

---

### Pytanie 3: Ręczniki (extra) ✅
**Q:** Czy ręczniki powinny być widoczne domyślnie czy ukryte?

**✅ POZOSTAJE JAK JEST:** Widoczne na liście usług (z flagą "Extra")

**Szczegóły:**
- Ręczniki są już dobrze zaimplementowane (usługa ID 13, `is_extra=true`)
- Pozostawiamy obecną strukturę bez zmian
- UI już poprawnie wyświetla ręczniki jako usługę ekstra

---

### Pytanie 4: Limitowane ilości (np. 3x pizza) ✅
**Q:** Jak checkować usługi z quantity > 1?

**✅ WYBRANA OPCJA B:** Osobne checkboxy dla każdej jednostki

**Szczegóły implementacji:**
- Jeśli `quantity = 3` → wyświetl **3 osobne checkboxy**
- Etykiety: "Pizza #1", "Pizza #2", "Pizza #3"
- Każdy checkbox jest osobnym wpisem w `package_service_usage`
- Pracownik może checkować pojedynczo w miarę wykorzystania

**Przykład (Pakiet 6):**
```
☐ Wejście do Strefy Relaksu (1,5 h) - dla 6 dzieci
☐ Karafka lemoniady #1
☐ Karafka lemoniady #2
☐ Pizza margherita #1
☐ Pizza margherita #2
☐ Pizza margherita #3
☐ Ręcznik #1
☐ Ręcznik #2
☐ Ręcznik #3
☐ Ręcznik #4
☐ Ręcznik #5
☐ Ręcznik #6
```

---

## 🔧 Szczegóły techniczne: Warianty usług

### Jak warianty działają w bazie danych?

**Tabela `package_type_services` - nowe kolumny:**
```sql
is_variant BOOLEAN DEFAULT FALSE
variant_group VARCHAR(50) NULLABLE
```

**Logika:**
1. Jeśli `is_variant = false` → normalna usługa (checkbox)
2. Jeśli `is_variant = true` I `variant_group IS NOT NULL` → usługa w grupie wariantów (radio button)
3. Wszystkie usługi z tym samym `variant_group` są wzajemnie wykluczające się

### Przykład dla Pakietu 4 (Kobiecy Chill):

**W tabeli `package_type_services`:**
```
package_type | service_id | quantity | is_variant | variant_group
-------------|------------|----------|------------|---------------
4            | 5          | 1        | TRUE       | "masaz_wariant"
4            | 2          | 1        | TRUE       | "masaz_wariant"
4            | 6          | 1        | TRUE       | "masaz_wariant_b"
4            | 7          | 1        | TRUE       | "masaz_wariant_b"
4            | 12         | 1        | FALSE      | NULL
4            | 9          | 1        | FALSE      | NULL
4            | 16         | 1        | FALSE      | NULL
4            | 19         | 1        | FALSE      | NULL (extra)
```

**Grupowanie:**
- **Grupa "masaz_wariant":** service_id 5 (Masaż relaksacyjny) + service_id 2 (Zabieg twarzy)
- **Grupa "masaz_wariant_b":** service_id 6 (Masaż shea) + service_id 7 (Peeling)

**UI wyświetli:**
```
Wybierz wariant (jedno z poniższych):

( ) Wariant A: Masaż relaksacyjny + Zabieg Pielęgnacji Twarzy
    - Masaż relaksacyjny (30 min)
    - Zabieg Pielęgnacji Twarzy (30 min)

( ) Wariant B: Masaż masłem shea + Peeling całego ciała
    - Masaż masłem shea (60 min)
    - Peeling całego ciała (15 min)

Pozostałe usługi:
☐ Jacuzzi VIP (60 min)
☐ Wejście do Strefy Relaksu (2,5 h)
☐ Voucher Strefa Smaku (80 zł)
☐ Wypożycz ręcznik i szlafrok
```

### Logika checkowania wariantów:

**Krok 1:** Pracownik wybiera radio button dla Wariantu A
**Krok 2:** System automatycznie zaznacza OBIE usługi z grupy "masaz_wariant":
- ✅ service_id 5 (Masaż relaksacyjny) → `package_service_usage.used_at = NOW()`
- ✅ service_id 2 (Zabieg twarzy) → `package_service_usage.used_at = NOW()`

**Krok 3:** Usługi z grupy "masaz_wariant_b" pozostają NIEZAZNACZONE (klient ich nie wybrał)

**⚠️ WAŻNE:** Gdy klient wybiera WARIANT (np. Wariant A), to wszystkie usługi w tym wariancie są traktowane jako JEDNA całość!

---

## 🔧 Szczegóły techniczne: Quantity > 1

### Jak działa quantity dla usług?

**Przykład: Pakiet 6 (Impreza Urodzinowa)**

**W tabeli `package_type_services`:**
```
package_type | service_id | quantity
-------------|------------|----------
6            | 10         | 1         # Wejście do strefy (1x dla całej grupy)
6            | 17         | 2         # Karafka lemoniady (2 sztuki)
6            | 18         | 3         # Pizza (3 sztuki)
6            | 19         | 6         # Ręcznik (6 sztuk - po 1 dla każdego dziecka)
```

**W tabeli `package_service_usage` (po utworzeniu pakietu):**
```
package_id | service_id | instance_number | used_at
-----------|------------|-----------------|--------
45         | 10         | NULL            | NULL      # Wejście (pojedyncze)
45         | 17         | 1               | NULL      # Lemoniada #1
45         | 17         | 2               | NULL      # Lemoniada #2
45         | 18         | 1               | NULL      # Pizza #1
45         | 18         | 2               | NULL      # Pizza #2
45         | 18         | 3               | NULL      # Pizza #3
45         | 19         | 1               | NULL      # Ręcznik #1
45         | 19         | 2               | NULL      # Ręcznik #2
45         | 19         | 3               | NULL      # Ręcznik #3
45         | 19         | 4               | NULL      # Ręcznik #4
45         | 19         | 5               | NULL      # Ręcznik #5
45         | 19         | 6               | NULL      # Ręcznik #6
```

**⚠️ NOWA KOLUMNA:** `instance_number` w `package_service_usage`
- `NULL` = usługa pojedyncza (quantity = 1)
- `1, 2, 3, ...` = numer instancji (quantity > 1)

**Migracja:**
```php
Schema::table('package_service_usage', function (Blueprint $table) {
    $table->integer('instance_number')->nullable()->after('service_id');
});
```

---

## 🔧 Szczegóły techniczne: Pakiety dla wielu osób

### Opcja A: Jeden pakiet dla pary (np. Pakiet 3, 5)

**Strategia:** Quantity określa ile razy usługa przysługuje

**Przykład: Pakiet 3 (Szept Miłości) dla Jana i Anny Kowalskich**

**W systemie:** Jeden pakiet `package_id = "20251016-01"`, `custom_id = "Jan i Anna Kowalscy"`

**W tabeli `package_service_usage`:**
```
package_id | service_id | instance_number | label                | used_at
-----------|------------|-----------------|----------------------|--------
20251016-01| 4          | 1               | "Osoba 1"            | NULL
20251016-01| 4          | 2               | "Osoba 2"            | NULL
20251016-01| 11         | NULL            | NULL                 | NULL  # Jacuzzi VIP (wspólne)
20251016-01| 10         | NULL            | NULL                 | NULL  # Wejście (wspólne)
20251016-01| 15         | NULL            | NULL                 | NULL  # Kolacja (wspólna)
20251016-01| 19         | 1               | "Osoba 1"            | NULL  # Ręcznik #1
20251016-01| 19         | 2               | "Osoba 2"            | NULL  # Ręcznik #2
```

**UI:**
```
Pakiet: 20251016-01 (Jan i Anna Kowalscy)
Typ: Pakiet 3 - Szept Miłości (dla 2 osób)

Strefa Odnowy:
☐ Masaż (ciepła świeca / czekolada) - Osoba 1
☐ Masaż (ciepła świeca / czekolada) - Osoba 2

Strefa Relaksu:
☐ Jacuzzi VIP (60 min)
☐ Wejście do Strefy Relaksu (1,5 h)

Strefa Smaku:
☐ Romantyczna kolacja (voucher 200 zł)

Extra:
☐ Ręcznik i szlafrok - Osoba 1
☐ Ręcznik i szlafrok - Osoba 2
```

### Opcja B: Więcej niż 2 osoby (np. 4 kobiety dla Pakietu 4)

**Strategia:** Obsługa tworzy N osobnych pakietów

**W systemie:**
- `package_id = "20251016-01"`, `custom_id = "Kowalska Anna"`
- `package_id = "20251016-02"`, `custom_id = "Nowak Maria"`
- `package_id = "20251016-03"`, `custom_id = "Wiśniewska Ewa"`
- `package_id = "20251016-04"`, `custom_id = "Zielińska Kasia"`

**Każdy pakiet jest niezależny** i ma swoje własne checkboxy.

---

## 🔥 Akcje do wykonania (po zatwierdzeniu)

### Krok 1: Backup obecnej bazy
```bash
./scripts/backup-database.sh
```

### Krok 2: Migracja - dodaj nowe kolumny
```php
// database/migrations/YYYY_MM_DD_add_variant_support_to_package_type_services.php
Schema::table('package_type_services', function (Blueprint $table) {
    $table->boolean('is_variant')->default(false);
    $table->string('variant_group')->nullable();
});

Schema::table('packages', function (Blueprint $table) {
    $table->integer('persons_count')->default(1);
});
```

### Krok 3: Seeder - usuń dummy dane i dodaj prawdziwe
```php
// database/seeders/RealPackageServicesSeeder.php
PackageService::truncate();
PackageTypeService::truncate();

// Dodaj 19 prawdziwych usług (patrz tabela powyżej)
// ...
```

### Krok 4: Aktualizuj modele
```php
// app/Models/PackageService.php
protected $fillable = [
    'name', 'zone', 'description', 'duration', 'is_extra', 'has_variants'
];

// app/Models/PackageTypeService.php (utworzyć jeśli nie ma)
class PackageTypeService extends Model {
    protected $fillable = [
        'package_type', 'service_id', 'quantity', 'is_variant', 'variant_group'
    ];
}
```

### Krok 5: UI - wyświetlanie wariantów
```tsx
// resources/js/Pages/Packages/Show.tsx
{service.is_variant ? (
  <div className="variant-group">
    <input type="radio" name={service.variant_group} ... />
  </div>
) : (
  <input type="checkbox" ... />
)}
```

### Krok 6: UI - pakiety dla wielu osób
```tsx
{pkg.persons_count > 1 && (
  <div className="alert">
    ℹ️ Pakiet dla {pkg.persons_count} osób
  </div>
)}
```

### Krok 7: Testy
- [ ] Utwórz pakiet typu 1 (Naturalna Harmonia)
- [ ] Sprawdź czy pokazują się poprawne usługi
- [ ] Zaznacz usługę jako wykorzystaną
- [ ] Wygeneruj PDF
- [ ] Powtórz dla pakietów 2-6

---

## 📅 Timeline (szacunkowy)

| Krok | Czas | Priorytet |
|------|------|-----------|
| Zatwierdzenie zakresu (ten dokument) | 1 dzień | 🔴 KRYTYCZNE |
| Migracja + seeder | 2h | 🔴 KRYTYCZNE |
| Aktualizacja modeli | 1h | 🔴 KRYTYCZNE |
| UI - wyświetlanie usług | 3h | 🟠 WYSOKIE |
| UI - warianty (radio buttons) | 2h | 🟠 WYSOKIE |
| UI - pakiety dla wielu osób | 2h | 🟡 ŚREDNIE |
| PDF - aktualizacja templates | 4h | 🟡 ŚREDNIE |
| Testy | 2h | 🟢 NISKIE |

**Łącznie:** ~16h (2 dni robocze)

---

## ✅ Potwierdzenie i zatwierdzenie

### Checklist przed implementacją:

- [x] Przeczytano cały dokument
- [x] Zweryfikowano z oficjalną stroną termygorce.pl/pakiety
- [x] Odpowiedziano na pytania 1-4 ✅
  - [x] Pytanie 1: Warianty → Radio buttons w UI
  - [x] Pytanie 2: Pakiety dla wielu osób → Quantity + numeracja
  - [x] Pytanie 3: Ręczniki → Pozostają jak są
  - [x] Pytanie 4: Limitowane ilości → Osobne checkboxy
- [x] Zatwierdzono listę usług (19 pozycji)
- [x] Zatwierdzono mapping pakietów do usług
- [ ] **MOŻNA ROZPOCZĄĆ IMPLEMENTACJĘ** ⬅️ Czeka na Twoje zatwierdzenie!

---

## 📋 Podsumowanie decyzji technicznych

### Nowe kolumny do dodania:

**1. `package_type_services` table:**
```sql
is_variant BOOLEAN DEFAULT FALSE
variant_group VARCHAR(50) NULLABLE
```

**2. `package_service_usage` table:**
```sql
instance_number INTEGER NULLABLE  -- dla quantity > 1
```

### Pakiety z wariantami (radio buttons):

| Pakiet | Warianty |
|--------|----------|
| **Pakiet 3** | Masaż świecą / czekoladą (x2 osoby) |
| **Pakiet 4** | Wariant A (masaż 30 min + zabieg) / Wariant B (masaż shea + peeling) |
| **Pakiet 5** | Masaż klasyczny / olejkami (x2 osoby) |

### Pakiety dla wielu osób (quantity):

| Pakiet | Osoby | Strategia |
|--------|-------|-----------|
| **Pakiet 3** | 2 osoby | Jeden pakiet, quantity=2 dla masażu i ręczników |
| **Pakiet 5** | 2 osoby | Jeden pakiet, quantity=2 dla masażu, vouchera i ręczników |
| **Pakiet 6** | 6 dzieci | Jeden pakiet, quantity=6 dla ręczników, 3 dla pizzy, 2 dla lemoniady |

### Pakiety z quantity > 1:

| Pakiet | Usługa | Quantity | UI |
|--------|--------|----------|-----|
| **Pakiet 3** | Masaż | 2 | "Masaż - Osoba 1", "Masaż - Osoba 2" |
| **Pakiet 3** | Ręcznik | 2 | "Ręcznik #1", "Ręcznik #2" |
| **Pakiet 5** | Masaż | 2 | "Masaż - Osoba 1", "Masaż - Osoba 2" |
| **Pakiet 5** | Voucher | 2 | "Voucher - Osoba 1", "Voucher - Osoba 2" |
| **Pakiet 5** | Ręcznik | 2 | "Ręcznik #1", "Ręcznik #2" |
| **Pakiet 6** | Lemoniada | 2 | "Karafka lemoniady #1", "Karafka lemoniady #2" |
| **Pakiet 6** | Pizza | 3 | "Pizza #1", "Pizza #2", "Pizza #3" |
| **Pakiet 6** | Ręcznik | 6 | "Ręcznik #1" ... "Ręcznik #6" |

---

**Status:** ✅ GOTOWE DO IMPLEMENTACJI (czeka na Twoje "OK")
**Data analizy:** 2025-10-16
**Następny krok:** Rozpoczęcie implementacji migracji i seedera

